# BOM Home2 画面設計（3分割レイアウト）

## 概要
- 3分割レイアウト: 左(製品リスト) | 中央(BOMツリー) | 右(詳細パネル)
- 左: 製品一覧をシンプルなリスト形式で表示（製品名のみ）
- 中央: 選択した製品のBOMツリー（Directory/LeafProductのみ、Documentは非表示）
- 右: 選択したノードの詳細情報
- **BOMツリーと詳細パネルはリサイザブル（デフォルト50:50）**

## 画面1: Directory選択時（直下に帳票・図面がある場合）

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ HEADER                                                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
┌────────────┬──────────────────────────────────────────────────│──────────────────────────────────────────────────────────┐
│ 製品リスト │ BOMツリー                                        │ 詳細パネル                                               │
│ (固定200px)│ (リサイザブル 50%)                              │ (リサイザブル 50%)                                       │
├────────────┤                                                  │                                                          │
│┌──────────┐│ ┌────────────────────────────────────────────┐ │ ┌────────────────────────────────────────────────────┐ │
││🔍 製品検索││ │ 🔍 検索   [種類: 全て ▼]                  │ │ │ HEADER                                             │ │
│└──────────┘│ └────────────────────────────────────────────┘ │ │ ┌────┐                                             │ │
│            │                                                  │ │ │ 📁 │ 産業用ポンプ PRD-1000   [詳細ページへ →]     │ │
│ 産業用     │ ABC製作所                                        │ │ └────┘ 製品                                        │ │
│ ポンプ     │                                                  │ └────────────────────────────────────────────────────┘ │
│ PRD-1000   │ v 📁 産業用ポンプ PRD-1000    #1000              │                                                          │
│ [選択中]   │                                                  │ ┌──────────────────────────────────────────────────┐ │
│            │   > 📁 ポンプ本体Assy ASSY-2000 #2000           │ │ 基本情報                                         │ │
│ 産業用     │                                                  │ ├──────────────────────────────────────────────────┤ │
│ コンプレ   │   > 📁 配管接続部Assy ASSY-3000 #3000           │ │                                                  │ │
│ ッサー     │                                                  │ │ 製品コード *              タイプ                 │ │
│ PRD-2000   │   > 📁 電装部Assy ASSY-4000 #4000               │ │ PRD-1000                  製品                   │ │
│            │                                                  │ │                                                  │ │
│ 産業用     │   > 📁 架台・筐体Assy ASSY-5000 #5000           │ │ 重量                      材質                   │ │
│ バルブ     │                                                  │ │ 18.4 kg                   SUS304                 │ │
│ PRD-3000   │                                                  │ │                                                  │ │
│            │                                                  │ │ 最大圧力                  流量                   │ │
│ 産業用     │                                                  │ │ 1.5 MPa                   50 L/min               │ │
│ 熱交換器   │                                                  │ │                                                  │ │
│ PRD-4000   │                                                  │ └──────────────────────────────────────────────────┘ │
│            │                                                  │                                                          │
│ 産業用     │                                                  │ ┌──────────────────────────────────────────────────┐ │
│ モーター   │                                                  │ │ カスタム情報                                     │ │
│ PRD-5000   │                                                  │ ├──────────────────────────────────────────────────┤ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ │ 担当部門                  ライフサイクル         │ │
│            │                                                  │ │ 生産技術1課               設計承認済 [緑]        │ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ │ 認証                      保証期間               │ │
│            │                                                  │ │ ISO9001                   24ヶ月                 │ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ └──────────────────────────────────────────────────┘ │
│            │                                                  │                                                          │
│            │                                                  │ ┌──────────────────────────────────────────────────┐ │
│            │                                                  │ │ システム情報                                     │ │
│            │                                                  │ ├──────────────────────────────────────────────────┤ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ │ 作成者                    更新者                 │ │
│            │                                                  │ │ user_001                  user_001               │ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ │ 作成日                    更新日                 │ │
│            │                                                  │ │ 2024-01-15                2024-03-20             │ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ └──────────────────────────────────────────────────┘ │
│            │                                                  │                                                          │
│            │                                                  │ ┌──────────────────────────────────────────────────┐ │
│            │                                                  │ │ 直下の帳票・図面ギャラリー                       │ │
│            │                                                  │ ├──────────────────────────────────────────────────┤ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ │ ┌──────────────┐  ┌──────────────┐            │ │
│            │                                                  │ │ │ 📄 製品仕様書│  │ 📄 見積書    │            │ │
│            │                                                  │ │ │              │  │              │            │ │
│            │                                                  │ │ │ v2           │  │ v2           │            │ │
│            │                                                  │ │ └──────────────┘  └──────────────┘            │ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ │ ┌──────────────┐  ┌──────────────┐            │ │
│            │                                                  │ │ │ 📄 検査成績書│  │ 図面         │            │ │
│            │                                                  │ │ │              │  │ DWG-HOUSING  │            │ │
│            │                                                  │ │ │ v1           │  │ -100         │            │ │
│            │                                                  │ │ └──────────────┘  └──────────────┘            │ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ │ - クリック → 詳細ページへ                    │ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ └──────────────────────────────────────────────────┘ │
└────────────┴──────────────────────────────────────────────────┴──────────────────────────────────────────────────────┘
```

## 画面2: Directory選択時（直下に帳票・図面がない場合）

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ HEADER                                                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
┌────────────┬──────────────────────────────────────────────────│──────────────────────────────────────────────────────────┐
│ 製品リスト │ BOMツリー                                        │ 詳細パネル                                               │
│ (固定200px)│ (リサイザブル 50%)                              │ (リサイザブル 50%)                                       │
├────────────┤                                                  │                                                          │
│┌──────────┐│ ┌────────────────────────────────────────────┐ │ ┌────────────────────────────────────────────────────┐ │
││🔍 製品検索││ │ 🔍 検索   [種類: 全て ▼]                  │ │ │ HEADER                                             │ │
│└──────────┘│ └────────────────────────────────────────────┘ │ │ ┌────┐                                             │ │
│            │                                                  │ │ │ 📁 │ 駆動部Assy ASSY-2100    [詳細ページへ →]     │ │
│ 産業用     │ ABC製作所                                        │ │ └────┘ SubAssy                                     │ │
│ ポンプ     │                                                  │ └────────────────────────────────────────────────────┘ │
│ PRD-1000   │ v 📁 産業用ポンプ PRD-1000    #1000              │                                                          │
│ [選択中]   │                                                  │ ┌──────────────────────────────────────────────────┐ │
│            │   v 📁 ポンプ本体Assy ASSY-2000 #2000           │ │ 基本情報                                         │ │
│ 産業用     │                                                  │ ├──────────────────────────────────────────────────┤ │
│ コンプレ   │     v 📁 駆動部Assy ASSY-2100 #2100             │ │                                                  │ │
│ ッサー     │                                                  │ │ Assyコード                タイプ                 │ │
│ PRD-2000   │       > 📊 ハウジング HOUSING-100 #1            │ │ ASSY-2100                 SubAssy                │ │
│            │                                                  │ │                                                  │ │
│ 産業用     │       > 📊 インペラー IMPELLER-80 #1            │ │ 重量                      回転速度               │ │
│ バルブ     │                                                  │ │ 8.2 kg                    3600 rpm               │ │
│ PRD-3000   │       > 📊 シャフト SHAFT-90   #1               │ │                                                  │ │
│            │                                                  │ └──────────────────────────────────────────────────┘ │
│ 産業用     │       > 📊 ベアリング BEARING-30  #1            │                                                          │
│ 熱交換器   │                                                  │ ┌──────────────────────────────────────────────────┐ │
│ PRD-4000   │       > 📊 カップリング COUPLING-40 #1          │ │ カスタム情報                                     │ │
│            │                                                  │ ├──────────────────────────────────────────────────┤ │
│ 産業用     │     > 📁 シール部SubAssy ASSY-2200 #2200        │ │                                                  │ │
│ モーター   │                                                  │ │ 担当部門                  ライフサイクル         │ │
│ PRD-5000   │   > 📁 配管接続部Assy ASSY-3000 #3000           │ │ 生産技術1課               設計承認済 [緑]        │ │
│            │                                                  │ │                                                  │ │
│            │   > 📁 電装部Assy ASSY-4000 #4000               │ └──────────────────────────────────────────────────┘ │
│            │                                                  │                                                          │
│            │   > 📁 架台・筐体Assy ASSY-5000 #5000           │ ┌──────────────────────────────────────────────────┐ │
│            │                                                  │ │ システム情報                                     │ │
│            │                                                  │ ├──────────────────────────────────────────────────┤ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ │ 作成者                    更新者                 │ │
│            │                                                  │ │ user_001                  user_001               │ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ │ 作成日                    更新日                 │ │
│            │                                                  │ │ 2024-01-25                2024-03-20             │ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ └──────────────────────────────────────────────────┘ │
│            │                                                  │                                                          │
│            │                                                  │                                                          │
└────────────┴──────────────────────────────────────────────────┴──────────────────────────────────────────────────────┘
```

## 画面3: LeafProduct選択時

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ HEADER                                                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
┌────────────┬──────────────────────────────────────────────────│──────────────────────────────────────────────────────────┐
│ 製品リスト │ BOMツリー                                        │ 詳細パネル                                               │
│ (固定200px)│ (リサイザブル 50%)                              │ (リサイザブル 50%)                                       │
├────────────┤                                                  │                                                          │
│┌──────────┐│ ┌────────────────────────────────────────────┐ │ ┌────────────────────────────────────────────────────┐ │
││🔍 製品検索││ │ 🔍 検索   [種類: 全て ▼]                  │ │ │ HEADER                                             │ │
│└──────────┘│ └────────────────────────────────────────────┘ │ │ ┌────┐                                             │ │
│            │                                                  │ │ │ 📊 │ ハウジング HOUSING-100  [詳細ページへ →]     │ │
│ 産業用     │ ABC製作所                                        │ │ └────┘ Leaf Product                                │ │
│ ポンプ     │                                                  │ └────────────────────────────────────────────────────┘ │
│ PRD-1000   │ v 📁 産業用ポンプ PRD-1000    #1000              │                                                          │
│ [選択中]   │                                                  │ ┌──────────────────────────────────────────────────┐ │
│            │   v 📁 ポンプ本体Assy ASSY-2000 #2000           │ │ 基本情報                                         │ │
│ 産業用     │                                                  │ ├──────────────────────────────────────────────────┤ │
│ コンプレ   │     v 📁 駆動部Assy ASSY-2100 #2100             │ │                                                  │ │
│ ッサー     │                                                  │ │ 部品コード                リビジョン             │ │
│ PRD-2000   │       > 📊 ハウジング HOUSING-100 #1            │ │ HOUSING-100               #1                     │ │
│            │                                                  │ │                                                  │ │
│ 産業用     │       > 📊 インペラー IMPELLER-80 #1            │ │ 図面番号                                         │ │
│ バルブ     │                                                  │ │ DWG-HOUSING-100                                  │ │
│ PRD-3000   │       > 📊 シャフト SHAFT-90   #1               │ │                                                  │ │
│            │                                                  │ └──────────────────────────────────────────────────┘ │
│ 産業用     │       > 📊 ベアリング BEARING-30  #1            │                                                          │
│ 熱交換器   │                                                  │ ┌──────────────────────────────────────────────────┐ │
│ PRD-4000   │       > 📊 カップリング COUPLING-40 #1          │ │ カスタム情報                                     │ │
│            │                                                  │ ├──────────────────────────────────────────────────┤ │
│ 産業用     │     > 📁 シール部SubAssy ASSY-2200 #2200        │ │                                                  │ │
│ モーター   │                                                  │ │ 担当部門                  ライフサイクル         │ │
│ PRD-5000   │   > 📁 配管接続部Assy ASSY-3000 #3000           │ │ 生産技術1課               設計承認済 [緑]        │ │
│            │                                                  │ │                                                  │ │
│            │   > 📁 電装部Assy ASSY-4000 #4000               │ └──────────────────────────────────────────────────┘ │
│            │                                                  │                                                          │
│            │   > 📁 架台・筐体Assy ASSY-5000 #5000           │ ┌──────────────────────────────────────────────────┐ │
│            │                                                  │ │ システム情報                                     │ │
│            │                                                  │ ├──────────────────────────────────────────────────┤ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ │ 作成者                    更新者                 │ │
│            │                                                  │ │ user_001                  user_001               │ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ │ 作成日                    更新日                 │ │
│            │                                                  │ │ 2024-01-15                2024-03-20             │ │
│            │                                                  │ │                                                  │ │
│            │                                                  │ └──────────────────────────────────────────────────┘ │
│            │                                                  │                                                          │
│            │                                                  │                                                          │
└────────────┴──────────────────────────────────────────────────┴──────────────────────────────────────────────────────┘
```

## レイアウト構造

### 3カラムレイアウト

#### 左: 製品リストパネル (固定200px)
- **上部: 製品検索窓**
  - 🔍アイコン付き検索フィールド
  - 製品名で検索
- 全製品をシンプルなリスト形式で縦に並べる
- 各リストアイテム表示項目:
  - 製品名のみ（例: 産業用ポンプ PRD-1000）
- クリックで製品選択 → 中央のBOMツリーが切り替わる
- 選択中の製品は [選択中] を表示

#### 中央: BOMツリーパネル (リサイザブル、デフォルト50%)
- **上部: 検索とフィルター**
  - 🔍検索フィールド
  - 種類選択プルダウン（全て/製品/Assy/SubAssy/LeafProductなど）
- 選択された製品のBOMツリーを表示
- **Documentは非表示**（Directory/LeafProductのみ）
- home1のBomTreeSidebarと同じツリー構造
- クリックでノード選択 → 右側の詳細パネルが更新
- **右側の詳細パネルとリサイズ可能**

#### 右: 詳細パネル (リサイザブル、デフォルト50%)
- ノードタイプによって表示内容が変わる
- **左側のBOMツリーパネルとリサイズ可能**

**Directory選択時:**
- Header: アイコン、名前、タイプ、詳細ページボタン
- メタデータ（上部）
  - 基本情報、カスタム情報、システム情報を縦に配置
  - **各セクション内はグリッドレイアウト（2カラム自動配置）**
  - label + valueのペアが左から右、上から下に流れるように配置
  - 必須項目には * マークを表示
- 直下の帳票・図面ギャラリー（下部）
  - Directoryは無視（LeafProductとDocumentのみ表示）
  - **カード形式で2カラムグリッド表示**
  - 各カード: アイコン + 名前 + バージョン/番号
  - クリック → 詳細ページへ遷移
  - 帳票・図面がない場合: 何も表示しない（セクション自体を非表示）

**LeafProduct選択時:**
- Header: アイコン、名前、タイプ、詳細ページボタン
- メタデータのみ表示（全幅使用）
  - 基本情報、カスタム情報、システム情報を縦に配置
  - **各セクション内はグリッドレイアウト（2カラム自動配置）**
  - label + valueのペアが左から右、上から下に流れるように配置

## 必要なコンポーネント構成

```
src/page-components/bom/home2/
├── ui/
│   ├── Home2Page.tsx                    # 新規: メインページ（3分割レイアウト + リサイザー）
│   ├── ProductListSidebar.tsx           # 新規: 製品リスト表示
│   ├── BomTreePanel.tsx                 # 新規: BOMツリー表示（Documentを除外）
│   └── DetailPanel.tsx                  # 新規: 詳細パネル
│       └── components/
│           ├── DetailHeader.tsx         # 新規: ヘッダー部分
│           ├── DirectoryDetail.tsx      # 新規: Directory詳細（メタデータ + ギャラリー）
│           ├── LeafProductDetail.tsx    # 新規: LeafProduct詳細（メタデータのみ）
│           ├── MetadataPanel.tsx        # 新規: メタデータ表示（縦配置、2カラムlabel/value）
│           └── GalleryView.tsx          # 新規: 帳票・図面ギャラリー
│
└── lib/
    └── index.ts                         # 新規: ヘルパー関数

shared/data/
├── types.ts                             # 既存（共有）
├── mockIndustrialPumpData.ts            # 既存（共有）
└── mockProductData.ts                   # 既存（共有）
```

## コンポーネント責務

### Home2Page.tsx
- 3カラムレイアウトの構築
- BOMツリーと詳細パネル間のリサイザー実装（デフォルト50:50）
- 製品選択状態の管理
- ノード選択状態の管理

### ProductListSidebar.tsx
- **製品検索窓の表示**
- 全製品リストの表示
- 製品カードの表示
- 製品選択ハンドリング
- 検索フィルタリング機能

### BomTreePanel.tsx
- **検索窓と種類選択フィルターの表示**
- 選択された製品のBOMツリー表示
- Documentノードを除外
- ノード選択ハンドリング
- 検索とフィルタリング機能

### DetailPanel.tsx
- ノードタイプによる表示切り替え
- DirectoryDetail / LeafProductDetail の呼び出し

### DetailHeader.tsx
- アイコン、名前、タイプ、詳細ページボタン

### DirectoryDetail.tsx
- メタデータ（上部）+ ギャラリー（下部、ある場合のみ）の縦配置レイアウト
- MetadataPanel + GalleryView の統合
- ギャラリーに表示するアイテムがない場合はGalleryViewを非表示

### LeafProductDetail.tsx
- メタデータのみ表示（全幅）
- MetadataPanel の使用

### MetadataPanel.tsx
- メタデータ表示（Directory/LeafProduct共通）
- 基本情報、カスタム情報、システム情報のセクションを縦に配置
- **各セクション内はグリッドレイアウト（2カラム自動配置）**
  - `display: grid; grid-template-columns: repeat(2, 1fr);`
  - label + valueのペアを1グリッドアイテムとして配置
  - 左から右、上から下に流れる自動配置
  - 必須項目には * マークを表示

### GalleryView.tsx
- 直下の帳票・図面を2カラムグリッドで表示
- カード形式（アイコン + 名前 + バージョン/番号）
- クリック → 詳細ページへ遷移
- 帳票・図面がない場合はコンポーネント自体を非表示

## 実装順序

1. **Phase 1: 基本レイアウト**
   - Home2Page.tsx（3カラムレイアウト）
   - ProductListSidebar.tsx
   - BomTreePanel.tsx

2. **Phase 2: 詳細パネル基本**
   - DetailPanel.tsx
   - DetailHeader.tsx
   - MetadataPanel.tsx（2カラムlabel/valueレイアウト）

3. **Phase 3: コンテンツ表示**
   - DirectoryDetail.tsx
   - LeafProductDetail.tsx
   - GalleryView.tsx

4. **Phase 4: 統合とテスト**
   - 全コンポーネントの統合
   - 状態管理の調整
