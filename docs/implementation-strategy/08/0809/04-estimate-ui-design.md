# 見積もり画面UI設計書

## 概要
製造業の中小企業向け見積もり機能のUI設計。材料選択、工程管理、その他費用、結果表示の4つのセクションで構成。

## ASCII画面設計

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│ 見積もり情報                                                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│ ■ 1. 材料選択                                                                   │
│ ┌─────────────────────────────────────────────────────────────────────────────┐ │
│ │ 材料名                   │ 計算式                  │ 価格(円)                │ │
│ ├─────────────────────────────────────────────────────────────────────────────┤ │
│ │ SS400 板材               │ length * width * 0.25   │  1,250                  │ │
│ ├─────────────────────────────────────────────────────────────────────────────┤ │
│ │ [+] 材料を選択                                                              │ │
│ │ ┌─────────────────────────────────────┐                                       │ │
│ │ │ [v] A5052 アルミ板                  │                                       │ │
│ │ │     SUS304 ステンレス板             │                                       │ │
│ │ │     ABS樹脂                         │                                       │ │
│ │ │     S45C 丸棒                       │                                       │ │
│ │ └─────────────────────────────────────┘                                       │ │
│ └─────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                 │
│ ■ 2. 工程選択                                                                   │
│ ┌─────────────────────────────────────────────────────────────────────────────┐ │
│ │ 工程名                   │ 時間(分) │ 価格(円)                                │ │
│ ├─────────────────────────────────────────────────────────────────────────────┤ │
│ │ 材料切断                 │    30    │  75,000                                 │ │
│ │ 溶接作業                 │    60    │  48,000                                 │ │
│ │ 表面処理                 │    45    │ 540,000                                 │ │
│ ├─────────────────────────────────────────────────────────────────────────────┤ │
│ │ [+] 工程を追加                                                              │ │
│ │ ┌─────────────────────────────────────┐                                       │ │
│ │ │ [v] 機械加工                        │                                       │ │
│ │ │     重量物組立                      │                                       │ │
│ │ │     (他の工程...)                   │                                       │ │
│ │ └─────────────────────────────────────┘                                       │ │
│ └─────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                 │
│ ■ 3. その他費用                                                                 │
│ ┌─────────────────────────────────────────────────────────────────────────────┐ │
│ │ 項目名                   │ 価格(円)                                          │ │
│ ├─────────────────────────────────────────────────────────────────────────────┤ │
│ │ 管理費                   │  50,000                                           │ │
│ │ 輸送費                   │  10,000                                           │ │
│ │ 梱包費                   │   5,000                                           │ │
│ ├─────────────────────────────────────────────────────────────────────────────┤ │
│ │ [+] 項目を追加                                                              │ │
│ └─────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                 │
│ ■ 4. 見積もり結果                                                               │
│ ┌─────────────────────────────────────────────────────────────────────────────┐ │
│ │                                                                             │ │
│ │ 材料費:     1,250円                                                          │ │
│ │ 工程費:   663,000円                                                          │ │
│ │ その他:    65,000円                                                          │ │
│ │ ─────────────────────                                                        │ │
│ │ 合計:     729,250円                                                          │ │
│ │                                                                             │ │
│ │                  [ 見積もりを確定 ]                                         │ │
│ │                                                                             │ │
│ └─────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## セクション詳細

### 1. 材料選択
- **テーブル形式**: 材料名、計算式、価格の3カラム
- **単一選択**: 一つの材料のみ選択可能
- **動的選択**: 「+材料を選択」ボタンでプルダウンから材料選択
- **価格計算**: 基本情報（length, width, height, weight）と計算式から自動算出

### 2. 工程選択
- **テーブル形式**: 工程名、時間、価格の3カラム
- **動的追加**: 「+工程を追加」ボタンでプルダウンから工程選択
- **時間入力**: ユーザーが工数を入力すると価格が自動計算
- **価格計算**: 計算式の結果 × 時間(分) で算出

### 3. その他費用
- **自由入力**: 項目名と価格を自由に設定
- **管理費等**: 雑費、管理費、輸送費などの項目
- **動的追加**: 「+項目を追加」で行を追加

### 4. 見積もり結果
- **内訳表示**: 各セクションの小計を表示
- **合計金額**: 全ての費用の総計
- **確定ボタン**: 見積もりデータを保存

## データフロー

```
基本情報(length, width, height, weight)
    ↓
材料マスター.formula → 材料費計算
    ↓
工程マスター.customFormula × 時間 → 工程費計算
    ↓
その他費用(手入力)
    ↓
合計 = 材料費 + 工程費 + その他費用
```

## 技術実装ポイント

1. **マスターデータ活用**
   - `src/page-components/setting/material-master/data/materialMaster.json`
   - `src/page-components/setting/process-master/data/processMaster.json`

2. **計算エンジン**
   - Function()を使った安全な計算式実行
   - 基本情報の変数置換システム

3. **UI コンポーネント**
   - shadcn/ui の Select, Input, Button, Table を活用
   - レスポンシブ対応（grid-cols-1 lg:grid-cols-2）

4. **状態管理**
   - 各セクションの選択状態
   - リアルタイム価格計算
   - 合計金額の自動更新