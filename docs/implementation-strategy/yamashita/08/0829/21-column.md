## テーブル分類

- **製品関連（parts）**: 製品IDによる紐付け
- **案件関連（projects）**: 案件IDによる紐付け

## 紐付け構造の概要

### 製品中心の管理フロー（parts関連）

```
製品
├── 図面(図面管理で管理)
├── 仕様書
├── 工程図面
├── 治具・ツール
├── 外注見積書
├── 外注納品書
├── 検査表
├── 工程表
├── 生産計画表
└── 検査成績書
```

### 案件中心の管理フロー（projects関連）

```
案件
├── 見積書
├── 受注書
├── 納品書
├── 請求書
└── 送り状
```

## 共通項目

| カラム   | カラム名         | データ型    | 必須 | デフォルト値 | 概要               | 備考 |
| -------- | ---------------- | ----------- | ---- | ------------ | ------------------ | ---- |
| 作成日時 | created_date     | DATETIME    | ○    | -            | レコード作成日時   |      |
| 作成者   | created_user_id  | VARCHAR(20) | ○    | -            | レコード作成者     |      |
| 更新日時 | modified_date    | DATETIME    | ○    | -            | 最終更新日時       |      |
| 更新者   | modified_user_id | VARCHAR(20) | ○    | -            | 最終更新ユーザー   |      |
| 備考     | remarks          | TEXT        |      | -            | 帳票に関しての備考 |      |

# 製品関連テーブル（parts）

> 製品IDによる紐付けで管理される帳票群

## 図面テーブル(詳細は図面のドキュメントにて)

[図面関連データ](https://www.notion.so/25c01261e40f805ab931ee2d6a12aa61?pvs=21)

| カラム       | カラム名                | データ型    | 必須 | デフォルト値 | 概要                           | 備考         |
| ------------ | ----------------------- | ----------- | ---- | ------------ | ------------------------------ | ------------ |
| 図面ID       | drawing_id              | VARCHAR(20) | ○    | -            | 図面の一意識別子               | 主キー       |
| 製品ID       | product_id              | VARCHAR(20) | ○    | -            | 製品を一意に識別               | **紐付けID** |
| 図面番号     | drawing_number          | VARCHAR(50) | ○    | -            | 社内で一意の図面管理番号       |              |
| 社外図面番号 | external_drawing_number | VARCHAR(50) |      | -            | 顧客や外注先から提示された番号 |              |

## 仕様書テーブル

| カラム   | カラム名         | データ型    | 必須 | デフォルト値 | 概要               | 備考         |
| -------- | ---------------- | ----------- | ---- | ------------ | ------------------ | ------------ |
| 仕様書ID | specification_id | VARCHAR(20) | ○    | -            | 仕様書の一意識別子 | 主キー       |
| 製品ID   | product_id       | VARCHAR(20) | ○    | -            | 製品を一意に識別   | **紐付けID** |

## 工程表テーブル

| カラム   | カラム名           | データ型    | 必須 | デフォルト値 | 概要                 | 備考                           |
| -------- | ------------------ | ----------- | ---- | ------------ | -------------------- | ------------------------------ |
| 工程表ID | process_drawing_id | VARCHAR(20) | ○    | -            | 工程図面の一意識別子 | 主キー                         |
| 製品ID   | product_id         | VARCHAR(20) | ○    | -            | 製品を一意に識別     | **紐付けID**（図面からの派生） |

## 治具・ツールテーブル

| カラム       | カラム名    | データ型    | 必須 | デフォルト値 | 概要                     | 備考                               |
| ------------ | ----------- | ----------- | ---- | ------------ | ------------------------ | ---------------------------------- |
| 治具ツールID | jig_tool_id | VARCHAR(20) | ○    | -            | 治具・ツールの一意識別子 | 主キー                             |
| 製品ID       | product_id  | VARCHAR(20) | ○    | -            | 製品を一意に識別         | **紐付けID**（図面等の登録を想定） |

## 外注見積書テーブル

| カラム       | カラム名           | データ型      | 必須 | デフォルト値 | 概要                   | 備考         |
| ------------ | ------------------ | ------------- | ---- | ------------ | ---------------------- | ------------ |
| 外注見積書ID | outsource_quote_id | VARCHAR(20)   | ○    | -            | 外注見積書の一意識別子 | 主キー       |
| 製品ID       | product_id         | VARCHAR(20)   | ○    | -            | 製品を一意に識別       | **紐付けID** |
| 数量         | quantity           | INT           | -    | -            | 見積対象数量           |              |
| 単価         | unit_price         | DECIMAL(10,2) | -    | -            | 見積単価               |              |
| 見積金額     | quote_amount       | DECIMAL(12,2) | -    | -            | 見積金額（数量×単価）  |              |
| 外注先       | outsourcer_id      | VARCHAR(20)   | -    | -            | 取引先idを紐付け       |              |

## 外注納品書テーブル

| カラム       | カラム名              | データ型    | 必須 | デフォルト値 | 概要                   | 備考         |
| ------------ | --------------------- | ----------- | ---- | ------------ | ---------------------- | ------------ |
| 外注納品書ID | outsource_delivery_id | VARCHAR(20) | ○    | -            | 外注納品書の一意識別子 | 主キー       |
| 製品ID       | product_id            | VARCHAR(20) | ○    | -            | 製品を一意に識別       | **紐付けID** |
| 発注書番号   | order_number          | VARCHAR(50) | -    | -            | 紐づく発注書番号       |              |
| 納品数量     | delivery_quantity     | INT         | -    | -            | 実際に納品された数量   |              |
| 納品日       | delivery_date         | DATE        | -    | -            | 納品日                 |              |
| 外注先       | outsourcer_id         | VARCHAR(20) | -    | -            | 取引先idを紐付け       |              |

## 検査表テーブル

| カラム   | カラム名            | データ型    | 必須 | デフォルト値 | 概要               | 備考         |
| -------- | ------------------- | ----------- | ---- | ------------ | ------------------ | ------------ |
| 検査表ID | inspection_sheet_id | VARCHAR(20) | ○    | -            | 検査表の一意識別子 | 主キー       |
| 製品ID   | product_id          | VARCHAR(20) | ○    | -            | 製品を一意に識別   | **紐付けID** |

## 工程表テーブル

| カラム   | カラム名         | データ型    | 必須 | デフォルト値 | 概要               | 備考                               |
| -------- | ---------------- | ----------- | ---- | ------------ | ------------------ | ---------------------------------- |
| 工程表ID | process_sheet_id | VARCHAR(20) | ○    | -            | 工程表の一意識別子 | 主キー                             |
| 製品ID   | product_id       | VARCHAR(20) | ○    | -            | 製品を一意に識別   | **紐付けID**（生産管理で詳細設計） |

## 生産計画表テーブル

| カラム       | カラム名           | データ型    | 必須 | デフォルト値 | 概要                   | 備考         |
| ------------ | ------------------ | ----------- | ---- | ------------ | ---------------------- | ------------ |
| 製品ID       | product_id         | VARCHAR(20) | ○    | -            | 製品を一意に識別       | **紐付けID** |
| 生産計画表ID | production_plan_id | VARCHAR(20) | ○    | -            | 生産計画表の一意識別子 | 主キー       |

## 検査成績書テーブル

| カラム       | カラム名             | データ型    | 必須 | デフォルト値 | 概要                                   | 備考         |
| ------------ | -------------------- | ----------- | ---- | ------------ | -------------------------------------- | ------------ |
| 製品ID       | product_id           | VARCHAR(20) | ○    | -            | 製品を一意に識別                       | **紐付けID** |
| 検査成績書ID | inspection_report_id | VARCHAR(20) | ○    | -            | 検査成績書の一意識別子                 | 主キー       |
| 検査日時     | inspection_datetime  | DATETIME    | -    | -            | 検査を行った日時                       |              |
| 検査担当者   | inspector_user_name  | VARCHAR(20) | -    | -            | 社内検査担当者、検査担当者の名前に変更 |              |

## 3DCAD

| カラム     | カラム名   | データ型    | 必須 | デフォルト値 | 概要             | 備考         |
| ---------- | ---------- | ----------- | ---- | ------------ | ---------------- | ------------ |
| 製品ID     | product_id | VARCHAR(20) | ○    | -            | 製品を一意に識別 | **紐付けID** |
| ファイル名 |            | file        |      |              |                  |              |
|            |            |             |      |              |                  |              |

---

# 案件関連テーブル（projects）

> 案件IDによる紐付けで管理される帳票群

## 見積書テーブル

| カラム           | カラム名      | データ型      | 必須 | デフォルト値 | 概要               | 備考                       |
| ---------------- | ------------- | ------------- | ---- | ------------ | ------------------ | -------------------------- |
| 案件ID           | project_id    | VARCHAR(20)   | ○    | -            | 案件を一意に識別   | **紐付けID✅**             |
| 見積書ID         | quote_id      | VARCHAR(20)   | ○    | -            | 見積書の一意識別子 | 主キー✅                   |
| 見積番号         | quote_number  | VARCHAR(50)   | ○    | -            | 一意の管理番号     | 自動採番されるものとする✅ |
| 顧客名           | customer_id   | VARCHAR(20)   | ○    | -            | 見積先顧客         | 顧客idから紐づく✅         |
| 品目・数量・単価 | quote_details | TEXT          |      | -            | 見積明細           | 製品一覧のUIで対応✅       |
| 金額             | total_amount  | DECIMAL(12,2) | ○    | -            | 見積総額           | ✅                         |

## 受注書テーブル

| カラム   | カラム名     | データ型    | 必須 | デフォルト値 | 概要               | 備考                              |
| -------- | ------------ | ----------- | ---- | ------------ | ------------------ | --------------------------------- |
| 受注書ID | order_id     | VARCHAR(20) | ○    | -            | 受注書の一意識別子 | 主キー                            |
| 案件ID   | project_id   | VARCHAR(20) | ○    | -            | 案件を一意に識別   | **紐付けID**                      |
| 受注番号 | order_number | VARCHAR(50) | -    | -            | 顧客からの注文番号 |                                   |
| 受注日   | order_date   | DATETIME    |      | -            | 受注日             | これ、必要か？                    |
| 顧客名   | customer_id  | VARCHAR(20) | ○    | -            | 顧客情報           | 紐づいている案件/取引先idから参照 |

## 納品書テーブル

| カラム     | カラム名            | データ型    | 必須 | デフォルト値 | 概要               | 備考                       |
| ---------- | ------------------- | ----------- | ---- | ------------ | ------------------ | -------------------------- |
| 納品書ID   | delivery_note_id    | VARCHAR(20) | ○    | -            | 納品書の一意識別子 | 主キー                     |
| 案件ID     | project_id          | VARCHAR(20) | ○    | -            | 案件を一意に識別   | **紐付けID**               |
| 納品書番号 | delivery_number     | VARCHAR(50) | ○    | -            | 納品を識別する番号 |                            |
| 納品日     | delivery_date       | DATE        | -    | -            | 納品日             |                            |
| 納品先     | delivery_address_id | VARCHAR(20) |      | -            | 顧客／納品先住所   | 顧客データベースからの参照 |
| 品目・数量 | delivery_details    | TEXT        |      | -            | 納品内容           |                            |

## 請求書テーブル

| カラム   | カラム名   | データ型    | 必須 | デフォルト値 | 概要               | 備考                                       |
| -------- | ---------- | ----------- | ---- | ------------ | ------------------ | ------------------------------------------ |
| 請求書ID | invoice_id | VARCHAR(20) | ○    | -            | 請求書の一意識別子 | 主キー                                     |
| 案件ID   | project_id | VARCHAR(20) | ○    | -            | 案件を一意に識別   | **紐付けID**（基本的には月末まとめて請求） |

## 送り状テーブル

| カラム   | カラム名         | データ型    | 必須 | デフォルト値 | 概要               | 備考         |
| -------- | ---------------- | ----------- | ---- | ------------ | ------------------ | ------------ |
| 送り状ID | shipping_note_id | VARCHAR(20) | ○    | -            | 送り状の一意識別子 | 主キー       |
| 案件ID   | project_id       | VARCHAR(20) | ○    | -            | 案件を一意に識別   | **紐付けID** |
| 出荷日   | shipping_date    | DATE        | -    | -            | 出荷日             |              |
