# BOM詳細パネル 画面設計

## 画面1: Directory(製品・フォルダ)表示

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────┐
│ HEADER                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────────────┘
┌──────────────────────┬──────────────────────────────────────────────────────────────────────────┐
│ BOMツリー            │ 詳細パネル                                                               │
│ ABC製作所            │                                                                          │
├──────────────────────┤ ┌────────────────────────────────────────────────────────────────────┐ │
│                      │ │ HEADER                                                             │ │
│ > 📁 産業用ポンプ    │ │ ┌────┐                                                             │ │
│   PRD-1000    #1000  │ │ │ 📁 │ 産業用ポンプ PRD-1000               [詳細ページへ →]       │ │
│                      │ │ └────┘ 製品                                                        │ │
│   > 📁 ポンプ本体Assy│ └────────────────────────────────────────────────────────────────────┘ │
│     ASSY-2000 #2000  │                                                                          │
│                      │ ┌──────────────────────────────────────────────────┬─────────────────┐ │
│   > 📁 配管接続部Assy│ │ メインコンテンツ                                 │ メタデータ      │ │
│     ASSY-3000 #3000  │ │                                                  │ (固定320px)     │ │
│                      │ │                                                  │                 │ │
│   > 📁 電装部Assy    │ │ ┌──────────────────────────────────────────┐ │ ┌─────────────┐ │ │
│     ASSY-4000 #4000  │ │ │ 子要素ギャラリービュー                   │ │ │ 基本情報    │ │ │
│                      │ │ │                                          │ │ ├─────────────┤ │ │
│ v 📁 架台・筐体Assy  │ │ │ ┌────┬────┬────┬────┬────┐         │ │ │ 製品コード  │ │ │
│   ASSY-5000   #5000  │ │ │ │[📁]│[📁]│[📁]│[📁]│[📁]│         │ │ │ PRD-1000    │ │ │
│                      │ │ │ │    │    │    │    │    │         │ │ ├─────────────┤ │ │
│   > 📁 ベースフレーム│ │ │ │ポン│配管│電装│架台│    │         │ │ │ リビジョン  │ │ │
│     SubAssy          │ │ │ │プ本│接続│部  │筐体│    │         │ │ │ Rev.E       │ │ │
│     ASSY-5100 #5100  │ │ │ │体  │部  │    │    │    │         │ │ ├─────────────┤ │ │
│                      │ │ │ └────┴────┴────┴────┴────┘         │ │ │ 重量        │ │ │
│   > 📊 保護カバー    │ │ │                                          │ │ │ 18.4 kg     │ │ │
│     COVER-900   #1   │ │ │ ┌────┬────┬────┬────┬────┐         │ │ ├─────────────┤ │ │
│                      │ │ │ │[📄]│[📄]│[📄]│    │    │         │ │ │ 材質        │ │ │
│   > 📊 点検口カバー  │ │ │ │    │    │    │    │    │         │ │ │ SUS304      │ │ │
│     HATCH-910   #1   │ │ │ │製品│見積│検査│    │    │         │ │ ├─────────────┤ │ │
│                      │ │ │ │仕様│書  │成績│    │    │         │ │ │ 最大圧力    │ │ │
│   > 📊 銘板          │ │ │ │書  │    │書  │    │    │         │ │ │ 1.5 MPa     │ │ │
│     NAMEPLATE-920 #1 │ │ │ └────┴────┴────┴────┴────┘         │ │ └─────────────┘ │ │
│                      │ │ │                                          │ │                 │ │ │
│   📄 製品仕様書  v2  │ │ │ - クリック → ノード選択              │ │ ┌─────────────┐ │ │
│   📄 見積書      v2  │ │ │ - ホバー → プレビュー                │ │ │ カスタム情報│ │ │
│   📄 検査成績書  v1  │ │ └──────────────────────────────────────────┘ │ ├─────────────┤ │ │
│                      │ │                                                  │ │ 担当部門    │ │ │
│                      │ │                                                  │ │ 生産技術1課 │ │ │
│                      │ │                                                  │ │ ├─────────────┤ │ │
│                      │ │                                                  │ │ │ライフサイクル│ │ │
│                      │ │                                                  │ │ │設計承認済[緑]│ │ │
│                      │ │                                                  │ │ └─────────────┘ │ │
│                      │ │                                                  │ │                 │ │ │
│                      │ │                                                  │ │ ┌─────────────┐ │ │
│                      │ │                                                  │ │ │ システム情報│ │ │
│                      │ │                                                  │ │ ├─────────────┤ │ │
│                      │ │                                                  │ │ │ 作成者      │ │ │
│                      │ │                                                  │ │ │ user_001    │ │ │
│                      │ │                                                  │ │ ├─────────────┤ │ │
│                      │ │                                                  │ │ │ 作成日      │ │ │
│                      │ │                                                  │ │ │ 2024-01-15  │ │ │
│                      │ │                                                  │ │ ├─────────────┤ │ │
│                      │ │                                                  │ │ │ 更新日      │ │ │
│                      │ │                                                  │ │ │ 2024-03-20  │ │ │
│                      │ │                                                  │ │ └─────────────┘ │ │
└──────────────────────┴──────────────────────────────────────────────────┴─────────────────┘ │
                                         └──────────────────────────────────────────────────────┘
```

## 画面2: LeafProduct(部品・図面)表示

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────┐
│ HEADER                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────────────┘
┌──────────────────────┬──────────────────────────────────────────────────────────────────────────┐
│ BOMツリー            │ 詳細パネル                                                               │
│ ABC製作所            │                                                                          │
├──────────────────────┤ ┌────────────────────────────────────────────────────────────────────┐ │
│                      │ │ HEADER                                                             │ │
│ > 📁 産業用ポンプ    │ │ ┌────┐                                                             │ │
│   PRD-1000    #1000  │ │ │ 📊 │ ハウジング HOUSING-100                  [詳細ページへ →]   │ │
│                      │ │ └────┘ Leaf Product                                                │ │
│ v 📁 ポンプ本体Assy  │ └────────────────────────────────────────────────────────────────────┘ │
│   ASSY-2000   #2000  │                                                                          │
│                      │ ┌──────────────────────────────────────────────────┬─────────────────┐ │
│   v 📁 駆動部Assy    │ │ メインコンテンツ                                 │ メタデータ      │ │
│     ASSY-2100 #2100  │ │                                                  │ (固定320px)     │ │
│                      │ │                                                  │                 │ │
│     > 📊 ハウジング  │ │ ┌──────────────────────────────────────────┐ │ ┌─────────────┐ │ │
│       HOUSING-100 #1 │ │ │                                          │ │ │ 基本情報    │ │ │
│                      │ │ │                                          │ │ ├─────────────┤ │ │
│     > 📊 インペラー  │ │ │         [図面プレビュー画像]             │ │ │ 部品コード  │ │ │
│       IMPELLER-80 #1 │ │ │                                          │ │ │ HOUSING-100 │ │ │
│                      │ │ │     PicturePreviewContainer             │ │ ├─────────────┤ │ │
│     > 📊 シャフト    │ │ │                                          │ │ │ リビジョン  │ │ │
│       SHAFT-90   #1  │ │ │     - ズームイン/アウト                  │ │ │ #1          │ │ │
│                      │ │ │     - 回転(時計/反時計)                │ │ ├─────────────┤ │ │
│     > 📊 ベアリング  │ │ │     - 画面に合わせる                     │ │ │ 図面番号    │ │ │
│       BEARING-30 #1  │ │ │     - ドラッグでパン                     │ │ │DWG-HOUSING- │ │ │
│                      │ │ │                                          │ │ │ 100         │ │ │
│     > 📊 カップリング│ │ │                                          │ │ └─────────────┘ │ │
│       COUPLING-40 #1 │ │ │                                          │ │                 │ │ │
│                      │ │ │                                          │ │ ┌─────────────┐ │ │
│     📄 駆動部組立    │ │ │                                          │ │ │ カスタム情報│ │ │
│        手順書    v1  │ │ └──────────────────────────────────────────┘ │ ├─────────────┤ │ │
│                      │ │                                                  │ │ 担当部門    │ │ │
│                      │ │                                                  │ │ 生産技術1課 │ │ │
│                      │ │                                                  │ │ ├─────────────┤ │ │
│                      │ │                                                  │ │ │ライフサイクル│ │ │
│                      │ │                                                  │ │ │設計承認済[緑]│ │ │
│                      │ │                                                  │ │ └─────────────┘ │ │
│                      │ │                                                  │ │                 │ │ │
│                      │ │                                                  │ │ ┌─────────────┐ │ │
│                      │ │                                                  │ │ │ システム情報│ │ │
│                      │ │                                                  │ │ ├─────────────┤ │ │
│                      │ │                                                  │ │ │ 作成者      │ │ │
│                      │ │                                                  │ │ │ user_001    │ │ │
│                      │ │                                                  │ │ ├─────────────┤ │ │
│                      │ │                                                  │ │ │ 作成日      │ │ │
│                      │ │                                                  │ │ │ 2024-01-15  │ │ │
│                      │ │                                                  │ │ ├─────────────┤ │ │
│                      │ │                                                  │ │ │ 更新日      │ │ │
│                      │ │                                                  │ │ │ 2024-03-20  │ │ │
│                      │ │                                                  │ │ └─────────────┘ │ │
└──────────────────────┴──────────────────────────────────────────────────┴─────────────────┘ │
                                         └──────────────────────────────────────────────────────┘
```

## 画面3: Document(文書)表示

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────┐
│ HEADER                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────────────┘
┌──────────────────────┬──────────────────────────────────────────────────────────────────────────┐
│ BOMツリー            │ 詳細パネル                                                               │
│ ABC製作所            │                                                                          │
├──────────────────────┤ ┌────────────────────────────────────────────────────────────────────┐ │
│                      │ │ HEADER                                                             │ │
│ v 📁 産業用ポンプ    │ │ ┌────┐                                                             │ │
│   PRD-1000    #1000  │ │ │ 📄 │ 見積書                                  [詳細ページへ →]   │ │
│                      │ │ └────┘ v2                                                          │ │
│   > 📁 ポンプ本体Assy│ └────────────────────────────────────────────────────────────────────┘ │
│     ASSY-2000 #2000  │                                                                          │
│                      │ ┌──────────────────────────────────────────────────┬─────────────────┐ │
│   > 📁 配管接続部Assy│ │ メインコンテンツ                                 │ メタデータ      │ │
│     ASSY-3000 #3000  │ │                                                  │ (固定320px)     │ │
│                      │ │                                                  │                 │ │
│   > 📁 電装部Assy    │ │ ┌──────────────────────────────────────────┐ │ ┌─────────────┐ │ │
│     ASSY-4000 #4000  │ │ │                                          │ │ │ 基本情報    │ │ │
│                      │ │ │                                          │ │ ├─────────────┤ │ │
│   > 📁 架台・筐体Assy│ │ │         [文書プレビュー画像]             │ │ │ 文書タイプ  │ │ │
│     ASSY-5000 #5000  │ │ │                                          │ │ │ 見積書      │ │ │
│                      │ │ │     PicturePreviewContainer             │ │ ├─────────────┤ │ │
│   > 📄 製品仕様書 v2 │ │ │                                          │ │ │ バージョン  │ │ │
│                      │ │ │     - ズームイン/アウト                  │ │ │ v2          │ │ │
│   > 📄 見積書     v2 │ │ │     - 回転(時計/反時計)                │ │ ├─────────────┤ │ │
│                      │ │ │     - 画面に合わせる                     │ │ │ ファイル名  │ │ │
│   > 📄 検査成績書 v1 │ │ │     - ドラッグでパン                     │ │ │ PRD-1000_   │ │ │
│                      │ │ │                                          │ │ │ 見積書_     │ │ │
│                      │ │ │                                          │ │ │ 2024Q2      │ │ │
│                      │ │ │                                          │ │ ├─────────────┤ │ │
│                      │ │ │                                          │ │ │ 金額        │ │ │
│                      │ │ │                                          │ │ │ ¥3,800,000  │ │ │
│                      │ │ └──────────────────────────────────────────┘ │ ├─────────────┤ │ │
│                      │ │                                                  │ │ 有効期限    │ │ │
│                      │ │                                                  │ │ 2024-06-30  │ │ │
│                      │ │                                                  │ │ └─────────────┘ │ │
│                      │ │                                                  │ │                 │ │ │
│                      │ │                                                  │ │ ┌─────────────┐ │ │
│                      │ │                                                  │ │ │ カスタム情報│ │ │
│                      │ │                                                  │ │ ├─────────────┤ │ │
│                      │ │                                                  │ │ │ 備考        │ │ │
│                      │ │                                                  │ │ │ 原材料費高騰│ │ │
│                      │ │                                                  │ │ │ により前回  │ │ │
│                      │ │                                                  │ │ │ 見積から5%  │ │ │
│                      │ │                                                  │ │ │ 増額        │ │ │
│                      │ │                                                  │ │ └─────────────┘ │ │
│                      │ │                                                  │ │                 │ │ │
│                      │ │                                                  │ │ ┌─────────────┐ │ │
│                      │ │                                                  │ │ │ システム情報│ │ │
│                      │ │                                                  │ │ ├─────────────┤ │ │
│                      │ │                                                  │ │ │ 作成日      │ │ │
│                      │ │                                                  │ │ │ 2024-04-01  │ │ │
│                      │ │                                                  │ │ └─────────────┘ │ │
└──────────────────────┴──────────────────────────────────────────────────┴─────────────────┘ │
                                         └──────────────────────────────────────────────────────┘
```


## レイアウト構造

### 2カラムレイアウト
- **左: メインコンテンツエリア** (flex-1)
  - タイプによって表示内容が変わる
  - Directory: 子要素のギャラリービュー
  - LeafProduct: 図面プレビュー
  - Document: 文書プレビュー

- **右: メタデータパネル** (固定320px)
  - 全タイプ共通のメタデータ表示
  - 3セクション構成
  - スクロール可能

## メタデータエリア詳細

### 基本情報セクション
- 製品コード / 図面番号 / 文書番号
- リビジョン / バージョン
- 重量、寸法、材質など(タイプに応じて)

### カスタム情報セクション
- 担当部門
- ライフサイクル(色付きバッジ)
- その他カスタムフィールド

### システム情報セクション
- 作成者
- 作成日時
- 更新者
- 更新日時

## 必要な新規ファイル構成

```
src/page-components/bom/home/ui/
├── BomDetailPanel.tsx                    # 既存(大幅リファクタリング)
└── components/
    ├── index.ts
    ├── BomDetailHeader.tsx               # 新規: ヘッダー部分
    ├── BomMetadataPanel.tsx              # 新規: メタデータ表示(セクション・フィールド含む)
    ├── BomLeafProductContent.tsx         # 新規: LeafProduct表示
    ├── BomDocumentContent.tsx            # 新規: Document表示
    └── BomDirectoryContent.tsx           # 新規: Directory表示

src/page-components/bom/home/lib/
└── index.ts                              # 既存(ヘルパー関数追加)

src/page-components/bom/home/data/
├── mockData.ts                           # 既存(画像URL追加)
└── types.ts                              # 既存(必要に応じて型追加)
```

## コンポーネント責務

### BomDetailPanel.tsx
- 全体のレイアウト管理
- ノードタイプによる表示切り替え
- Header + 2カラムレイアウト(左: メインコンテンツ、右: メタデータ)

### BomDetailHeader.tsx
- アイコン表示
- タイトル表示
- バッジ表示
- 詳細ページボタン

### BomMetadataPanel.tsx
- 3つのセクション管理(基本情報、カスタム情報、システム情報)
- スクロール可能な固定幅パネル(320px)

### BomLeafProductContent.tsx
- PicturePreviewContainerの統合
- 図面画像の表示

### BomDocumentContent.tsx
- PicturePreviewContainerの統合
- 文書プレビュー画像の表示

### BomDirectoryContent.tsx
- 子要素のギャラリー表示
- グリッドレイアウト
- クリックでノード選択
- サムネイル画像表示


## データ拡張

### mockData.ts に追加
```typescript
// LeafProduct に画像URL追加
interface LeafProduct {
  // ... 既存フィールド
  previewImageUrl?: string; // Unsplash等からのランダム画像
}

// DrawingFile に画像URL追加
interface DrawingFile {
  // ... 既存フィールド
  previewImageUrl?: string; // 図面のプレビュー画像
}

// DirectoryDocument に画像URL追加
interface DirectoryDocument {
  // ... 既存フィールド
  versions: Array<{
    // ... 既存フィールド
    previewImageUrl?: string; // 文書のプレビュー画像
  }>;
}
```

## 実装順序

1. **Phase 1: ヘッダーとメタデータパネル**
   - BomDetailHeader.tsx
   - BomMetadataPanel.tsx(セクション・フィールド表示を内包)

2. **Phase 2: コンテンツコンポーネント**
   - BomLeafProductContent.tsx
   - BomDocumentContent.tsx
   - BomDirectoryContent.tsx

3. **Phase 3: データ拡張**
   - mockData.ts に画像URL追加

4. **Phase 4: メイン統合**
   - BomDetailPanel.tsx のリファクタリング
   - 全コンポーネントの統合
