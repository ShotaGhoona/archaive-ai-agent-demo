# 04-General Agent 詳細仕様書

## 概要

General Agentは、製造業の幅広い相談に対応する万能型AIエージェントです。設計、材料選定、加工方法、品質管理など、製造現場で発生する一般的な技術課題に対して、**ベテラン製造コンサルタント**の視点から実践的なアドバイスを提供します。

## 🎯 エージェントの目的と価値

### 解決する課題
- **技術者の属人化問題** - ベテラン職人の知見をAI化して共有
- **迅速な技術判断** - 設計・製造判断の時間短縮（従来数時間→数分）
- **品質の標準化** - 一貫した技術アドバイスで品質ばらつき解消
- **新人教育支援** - 実務的な技術知識の効率的な習得

### 提供価値
- **24時間対応の技術相談** - 夜間・休日でもアクセス可能
- **実践的なアドバイス** - 現場で使える具体的な情報
- **コスト最適化提案** - 品質とコストのバランス重視
- **最新動向反映** - 業界トレンドを含めた助言

## 📋 機能仕様

### 対応分野
1. **機械設計・CAD設計**
   - 設計手法、設計検証、図面作成
   - 幾何公差、嵌め合い、強度計算
   
2. **材料選定・材料特性**
   - 金属材料（鉄鋼、非鉄）、樹脂材料
   - 材料特性、コスト比較、調達性
   
3. **製造工程・加工技術**
   - 切削加工、プレス加工、溶接、成形
   - 工程設計、段取り最適化
   
4. **品質管理・検査技術**
   - 測定方法、検査基準、不良解析
   - QC工程、品質保証システム
   
5. **安全管理・規格対応**
   - 安全基準、法規制、業界規格
   - リスクアセスメント
   
6. **コスト最適化・生産性向上**
   - 原価低減、工数削減、自動化検討

### クイックアクション（6種類）
```typescript
quickActions: [
  { id: 'design-basics', label: '設計の基本を教えて', icon: BookOpen },
  { id: 'material-selection', label: '材料の選び方', icon: Settings },
  { id: 'tolerance-guide', label: '公差設定のガイド', icon: Calculator },
  { id: 'processing-methods', label: '加工方法について', icon: FileText },
  { id: 'quality-control', label: '品質管理のポイント', icon: Search },
  { id: 'safety-guidelines', label: '安全ガイドライン', icon: HelpCircle }
]
```

## 🧠 AIプロンプト戦略

### システムプロンプトの構造

```
製造業専門コンサルタントとしての役割定義
├── 専門分野の明確化（設計、材料、製造、品質、安全、コスト）
├── 回答方針（実践的、わかりやすさ、安全性、効率性、最新性）
├── 対応内容の具体化
└── 回答品質の要件（日本語、理解しやすい説明）
```

### プロンプト最適化ポイント
1. **業界特化語彙** - 製造業専門用語の正確な使用
2. **実践重視** - 理論より現場で使える情報を優先
3. **安全第一** - 安全性を最優先とした回答
4. **段階的説明** - 初心者から上級者まで対応
5. **具体例提示** - 抽象的な説明より具体的な事例

### ユーザーレベル対応

#### 初心者向け (experienceLevel: 'beginner')
- 基本概念から丁寧に説明
- 専門用語は必ず解説
- 図解や具体例を多用
- 安全注意事項を強調

#### 中級者向け (experienceLevel: 'intermediate')  
- 適度な専門性を保持
- 実践的な情報を重視
- 効率化のポイント提示
- トラブルシューティング含む

#### 上級者向け (experienceLevel: 'expert')
- 高度な技術情報提供
- 最新動向・トレンド反映
- 詳細な分析と提案
- 代替案・最適化案提示

## 🔧 技術実装詳細

### フロントエンド実装

#### GeneralChatContent.tsx
```typescript
// 基本的なチャット表示のみを実装
// 特殊機能は不要なため、共有のChatContent.tsxでも代用可能
const GeneralChatContent: React.FC<AgentContentProps> = ({ 
  messages, 
  isLoading, 
  agentConfig 
}) => {
  // ウェルカムメッセージ表示
  // 自動スクロール機能
  // メッセージ一覧表示
};
```

#### agentConfigs.ts での設定
```typescript
general: {
  id: 'general',
  name: 'なんでもAI',
  icon: MessageCircle,
  description: '一般的な相談・質問に対応',
  color: '#3b82f6', // ブルー系
  category: AgentCategory.GENERAL,
  welcomeMessage: 'ARCHAIVE AIエージェントへようこそ。なんでもお聞きください。',
  quickActions: [
    // 6つのクイックアクション
  ]
}
```

### バックエンド実装

#### route.ts (src/app/api/ai-agents/general/)
```typescript
class GeneralAgent extends BaseAgent {
  config: AgentConfig = {
    id: 'general',
    name: '一般エージェント',
    version: '1.0.0',
    inputType: 'json', // テキスト入力のみ
    capabilities: [{ type: 'text' }] // 画像解析は不要
  };

  async process(request: AgentRequest<GeneralMetadata>): Promise<AgentResponse> {
    // 1. リクエスト検証
    // 2. システムプロンプト構築（ユーザープリファレンス反映）
    // 3. 会話履歴統合
    // 4. OpenAI API呼び出し
    // 5. レスポンス作成・メトリクス記録
  }
}
```

#### システムプロンプトの動的構築
```typescript
private buildSystemPrompt(metadata?: GeneralMetadata): string {
  let systemPrompt = basePrompt; // 基本プロンプト
  
  // ユーザープリファレンスの適用
  if (metadata?.preferences) {
    // 経験レベル別の対応調整
    // 単位系の選択（メートル法/ヤード・ポンド法）
    // 業界フォーカスの設定
  }
  
  return systemPrompt;
}
```

## 📊 利用分析・最適化

### 想定される質問パターン
1. **設計相談** (40%)
   - 「この形状の部品設計で注意点は？」
   - 「強度計算の方法を教えて」
   
2. **材料選定** (25%)
   - 「用途に最適な材料は？」
   - 「コストと性能のバランスは？」
   
3. **加工方法** (20%)
   - 「効率的な加工順序は？」
   - 「この形状の加工は可能？」
   
4. **品質・検査** (10%)
   - 「検査方法の選び方」
   - 「品質基準の設定方法」
   
5. **その他** (5%)
   - 「安全基準について」
   - 「規格・法令の確認」

### パフォーマンス指標

#### レスポンス品質
- **専門性** - 技術的正確性 95%以上
- **実用性** - 現場適用可能性 90%以上  
- **理解度** - ユーザー理解率 85%以上

#### 応答性能
- **応答時間** - 平均3秒以内
- **トークン効率** - 1質問あたり平均1,500トークン
- **コスト** - 1質問あたり約0.5円

#### ユーザー満足度
- **解決率** - 質問解決率 80%以上
- **継続利用** - 週次利用率 70%以上
- **推奨度** - NPS 50以上

## 🔄 継続改善プロセス

### フィードバック収集
1. **利用ログ分析** - よくある質問パターンの特定
2. **ユーザー評価** - 回答の有用性評価
3. **エラー分析** - 不適切な回答の改善

### プロンプト最適化
1. **A/Bテスト** - 異なるプロンプトでの効果測定
2. **業界動向反映** - 最新技術トレンドの組み込み
3. **専門用語更新** - 用語集の継続アップデート

### 機能拡張計画
1. **専門分野細分化** - 業界特化版エージェントへの発展
2. **外部システム連携** - CADソフト、ERPシステムとの統合
3. **多言語対応** - 海外展開に向けた国際化

General Agentは、製造業のデジタル化における**入り口**として、ユーザーがAI活用に慣れ親しむための重要な役割を担っています。シンプルながら実用的な機能で、確実な価値提供を実現します。